#include "iom128v.h"
#include "macros.h"

void delay(int ms)
{
 int c1, c2;
 for(c1=0;c1<ms;c1++)
  for(c2=0;c2<970;c2++) NOP();
}

void main()
{
 char seg[3]={0b00000101, 0b00011010, 0b01100000};
 int item[4]={6,7,1,2};
 int i,j;
 DDRC=0b10000111;    // управление дешифратором шины данных
 DDRA=0xFF;		   // шина данных
 DDRG=0x01;		   // разрешение работы дешифратора
 PORTG=0;	 	   // установка на выходе PG0 лог. 0
 PORTA=0;		   // выключить свечение матричного индикатора
 PORTC=0;		   // выбираем столбцы
 PORTC=5;		   // выбираем строки
 PORTC=1;		   // выключение индикатора H8
 PORTA=0xFF; 
 PORTC=1;		   // выключение индикатора H8
 PORTC=2;		   // выключение индикатора H9
 PORTC=7;		   // выбор индикатора H7
 PORTC=6;		   // выбор индикатора H6
 while(1)
 {
  for(i=0;i<4;i++)
  {
   
   for(j=0;j<3;j++)
   {
   	PORTC=item[i];
   	PORTA=~seg[j];   // зажигаем сегменты f и e
   	delay(100);    	// формирование временной задержки 
   	PORTA=0xFF;	   	// гасим сегмент g
   }
  }
 }
}
