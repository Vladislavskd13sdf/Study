#include "iom128v.h"
#include "macros.h"

void delay(int ms)
{
 int c1, c2;
 for(c1=0;c1<ms;c1++)
  for(c2=0;c2<970;c2++) NOP();
}

void main()
{
 char seg[6]={0b00010000, 0b00100000, 0b01000000, 0b00000010, 0b00000100, 0b00000001};
 char i;
 DDRC=0b10000111;    // управление дешифратором шины данных
 DDRA=0xFF;		   // шина данных
 DDRG=0x01;		   // разрешение работы дешифратора
 PORTG=0;	 	   // установка на выходе PG0 лог. 0
 PORTA=0;		   // выключить свечение матричного индикатора
 PORTC=0;		   // выбираем столбцы
 PORTC=5;		   // выбираем строки
 PORTC=1;		   // выключение индикатора H8
 PORTA=0xFF; 
 PORTC=1;		   // выключение индикатора H8
 PORTC=2;		   // выключение индикатора H9
 PORTC=7;		   // выбор индикатора H7
 PORTC=6;		   // выбор индикатора H6
 while(1)
 {
  
   PORTA=~0b01000000; 	// зажигаем сегмент g
   delay(200);    	// формирование временной задержки
   PORTA=0xFF;	   	// гасим сегмент g
   PORTC=7;		   	// выбор индикатора H7
   PORTA=~0b00001000;	// зажигаем сегмент g
   delay(200);     	// формирование временной задержки
   PORTA=0xFF;	   	// гасим сегмент g
   PORTC=1;		   	// выбор индикатора H8
   PORTA=~0b00001000;  	// зажигаем сегмент g
   delay(200);     	// формирование временной задержки
   PORTA=0xFF;	   	// гасим сегмент g
   PORTC=2;		   	// выбор индикатора H9
   PORTA=~0b00001000; 	// зажигаем сегмент g
   delay(200);    	// формирование временной задержки
   PORTA=~0b01100000;   // зажигаем сегменты b и c
   delay(200);     	// формирование временной задержки
   PORTA=~0b00010010;   // зажигаем сегменты a и d
   delay(200);     	// формирование временной задержки
   PORTA=0xFF;	   	// гасим сегменты a и d
   PORTC=1;		   	// выбор индикатора H8
   PORTA=~0b00010010;   // зажигаем сегменты a и d
   delay(200);     	// формирование временной задержки
   PORTA=0xFF;	   	// гасим сегменты a и d
   PORTC=7;		   	// выбор индикатора H7
   PORTA=~0b00010010;   // зажигаем сегменты a и d
   delay(200);     	// формирование временной задержки
   PORTA=0xFF;	   	// гасим сегменты a и d
   PORTC=6;		   	// выбор индикатора H6
   PORTA=~0b00010010;   // зажигаем сегменты a и d
   delay(200);     	// формирование временной задержки
   PORTA=~0b00000101;   // зажигаем сегменты f и e
   delay(200);    	// формирование временной задержки  
 }
}
